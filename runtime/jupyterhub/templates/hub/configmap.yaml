kind: ConfigMap
apiVersion: v1
metadata:
  name: {{ include "jupyterhub.hub.fullname" . }}
  labels:
    {{- include "jupyterhub.labels" . | nindent 4 }}
data:
  {{- /*
    Resource names exposed to reliably reference them.
    These are used by core to resolve Kubernetes resource names.

    user-scheduler: "my-helm-release-user-scheduler"
    ...
  */}}
  {{- include "jupyterhub.name-templates" . | nindent 2 }}

  {{- /*
    YAML configuration files from config/
    These are stored with a "config__" prefix to distinguish them.
    core/jupyterhub_config.py will extract them to hub-config/ subdirectory.

    Note: Python files are in the Docker image under /usr/local/lib/core/.
  */}}
  {{- range $path, $_ := .Files.Glob "config/*.yaml" }}
  config__{{ base $path }}: |
{{ $.Files.Get $path | indent 4 }}
  {{- end }}

  {{- /*
    Store away a checksum of the hook-image-puller daemonset so future upgrades
    can compare and decide if it should run or not using the `lookup` function.
  */}}
  checksum_hook-image-puller: {{ include "jupyterhub.imagePuller.daemonset.hook.checksum" . | quote }}
