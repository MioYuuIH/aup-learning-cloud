{% extends "page.html" %}

{% block main %}
<div class="container">
  <div class="row">
    <div class="col-md-6 col-md-offset-3">
      <h1>Reset Password: {{ target_user }}</h1>

      {% if not target_user %}
      <div class="alert alert-warning">
        No user specified. Please go back to the <a href="{{ base_url }}admin">Admin page</a> and click "Reset PW" on a user.
      </div>
      {% else %}

      {% if success %}
      <div class="alert alert-success">
        Password for <strong>{{ target_user }}</strong> has been reset successfully!
        <br><a href="{{ base_url }}admin">Back to Admin</a>
      </div>
      {% endif %}

      {% if error %}
      <div class="alert alert-danger">
        {{ error | replace('+', ' ') }}
      </div>
      {% endif %}

      {% if not success %}
      <form action="{{ base_url }}admin/reset-password" method="post" role="form">
        <input type="hidden" name="_xsrf" value="{{ xsrf_token }}"/>
        <input type="hidden" name="target_user" value="{{ target_user }}"/>

        <div class="form-group mb-3">
          <label for="new_password">New Password:</label>
          <input
            id="new_password"
            type="password"
            class="form-control"
            name="new_password"
            required
            minlength="1"
          />
        </div>

        <div class="form-group mb-3">
          <label for="confirm_password">Confirm Password:</label>
          <input
            id="confirm_password"
            type="password"
            class="form-control"
            name="confirm_password"
            required
          />
        </div>

        <div class="form-group mb-3">
          <div class="form-check">
            <input type="checkbox" class="form-check-input" id="force_change" name="force_change" checked />
            <label class="form-check-label" for="force_change">
              Require user to change password on next login
            </label>
          </div>
        </div>

        <div class="form-group">
          <input
            type="submit"
            class="btn btn-primary"
            value="Reset Password"
          />
          <a href="{{ base_url }}admin" class="btn btn-secondary">Cancel</a>
        </div>
      </form>
      {% endif %}

      {% endif %}
    </div>
  </div>
</div>
{% endblock %}
