{% extends "page.html" %}

{% block main %}
<div class="container">
  <div class="row">
    <div class="col-md-6 col-md-offset-3">
      <h1>Change Password</h1>

      {% if forced_change %}
      <div class="alert alert-warning">
        <strong>Password Change Required</strong><br>
        You are using a default password. Please change your password before continuing.
      </div>
      {% endif %}

      {% if password_changed %}
      <div class="alert alert-success">
        Password changed successfully!
        {% if forced_change %}
        <br>You can now <a href="{{ base_url }}home">continue to the home page</a>.
        {% endif %}
      </div>
      {% endif %}

      {% if not password_changed %}
      <form action="{{ base_url }}auth/change-password" method="post" role="form">
        <input type="hidden" name="_xsrf" value="{{ xsrf_token }}"/>

        <div class="form-group">
          <label for="current_password">Current Password{% if forced_change %} (Default Password){% endif %}:</label>
          <input
            id="current_password"
            type="password"
            class="form-control"
            name="current_password"
            required
            autofocus
          />
        </div>

        <div class="form-group">
          <label for="new_password">New Password:</label>
          <input
            id="new_password"
            type="password"
            class="form-control"
            name="new_password"
            required
          />
        </div>

        <div class="form-group">
          <label for="confirm_password">Confirm New Password:</label>
          <input
            id="confirm_password"
            type="password"
            class="form-control"
            name="confirm_password"
            required
          />
        </div>

        <div class="form-group">
          <input
            type="submit"
            class="btn btn-primary"
            value="Change Password"
          />
          {% if not forced_change %}
          <a href="{{ base_url }}home" class="btn btn-default">Cancel</a>
          {% endif %}
        </div>
      </form>
      {% endif %}
    </div>
  </div>
</div>
{% endblock %}
